var data1 = [
    [
      {
        "year": "2008",
        "UnmarriedRural": 5741,
        "UnmarriedUrban": 17307,
        "MarriedRural": 4646,
        "MarriedUrban": 2879
      },
      {
      "year": "2009",
        "UnmarriedRural": 5790,
        "UnmarriedUrban": 16366,
        "MarriedRural": 4140,
        "MarriedUrban": 2608
      },
      {
      "year": "2010",
        "UnmarriedRural": 5741,
        "UnmarriedUrban": 15549,
        "MarriedRural": 3287,
        "MarriedUrban": 1961
      },
      {
        "year": "2011",
        "UnmarriedRural": 5517,
        "UnmarriedUrban": 14451,
        "MarriedRural": 2611,
        "MarriedUrban": 1380
      },
      {
        "year": "2012",
        "UnmarriedRural": 5493,
        "UnmarriedUrban": 14938,
        "MarriedRural": 2205,
        "MarriedUrban": 1133
      },
      {
        "year": "2013",
        "UnmarriedRural": 5180,
        "UnmarriedUrban": 14682,
        "MarriedRural": 1783,
        "MarriedUrban": 948
      },
      {
        "year": "2014",
        "UnmarriedRural": 5108,
        "UnmarriedUrban": 15032,
        "MarriedRural": 1398,
        "MarriedUrban": 763
      },
      {
        "year": "2015",
        "UnmarriedRural": 4430,
        "UnmarriedUrban": 14729,
        "MarriedRural": 1275,
        "MarriedUrban": 749
      },
      {
        "year": "2016",
        "UnmarriedRural": 4216,
        "UnmarriedUrban": 15676,
        "MarriedRural": 1075,
        "MarriedUrban": 618
      },
      {
        "year": "2017",
        "UnmarriedRural": 3690,
        "UnmarriedUrban": 15732,
        "MarriedRural": 1090,
        "MarriedUrban": 635
      }
    ],
    [
        {
            "year": "2008",
            "UnmarriedRural": 10495,
            "UnmarriedUrban": 17307,
            "MarriedRural": 37355,
            "MarriedUrban": 29343
          },
          {
          "year": "2009",
            "UnmarriedRural": 10072,
            "UnmarriedUrban": 16366,
            "MarriedRural": 33954,
            "MarriedUrban": 27024
          },
          {
          "year": "2010",
            "UnmarriedRural": 10327,
            "UnmarriedUrban": 15549,
            "MarriedRural": 31151,
            "MarriedUrban": 23110
          },
          {
            "year": "2011",
            "UnmarriedRural": 10189,
            "UnmarriedUrban": 14451,
            "MarriedRural": 27270,
            "MarriedUrban": 19135
          },
          {
            "year": "2012",
            "UnmarriedRural": 11152,
            "UnmarriedUrban": 14938,
            "MarriedRural": 25182,
            "MarriedUrban": 17099
          },
          {
            "year": "2013",
            "UnmarriedRural": 11363,
            "UnmarriedUrban": 14628,
            "MarriedRural": 22454,
            "MarriedUrban": 14713
          },
          {
            "year": "2014",
            "UnmarriedRural": 12030,
            "UnmarriedUrban": 15032,
            "MarriedRural": 20248,
            "MarriedUrban": 12975
          },
          {
            "year": "2015",
            "UnmarriedRural": 11246,
            "UnmarriedUrban": 14729,
            "MarriedRural": 18540,
            "MarriedUrban": 12622
          },
          {
            "year": "2016",
            "UnmarriedRural": 11446,
            "UnmarriedUrban": 15676,
            "MarriedRural": 17089,
            "MarriedUrban": 11559
          },
          {
            "year": "2017",
            "UnmarriedRural": 10716,
            "UnmarriedUrban": 15732,
            "MarriedRural": 17545,
            "MarriedUrban": 11935
          }  
    ],
    [
        {
            "year": "2008",
            "UnmarriedRural": 6258,
            "UnmarriedUrban": 14906,
            "MarriedRural": 55353,
            "MarriedUrban": 75983
          },
          {
          "year": "2009",
            "UnmarriedRural": 6559,
            "UnmarriedUrban": 15540,
            "MarriedRural": 55674,
            "MarriedUrban": 76880
          },
          {
          "year": "2010",
            "UnmarriedRural": 6959,
            "UnmarriedUrban": 15312,
            "MarriedRural": 56351,
            "MarriedUrban": 74604
          },
          {
            "year": "2011",
            "UnmarriedRural": 7034,
            "UnmarriedUrban": 14450,
            "MarriedRural": 53394,
            "MarriedUrban": 68477
          },
          {
            "year": "2012",
            "UnmarriedRural": 7451,
            "UnmarriedUrban": 14947,
            "MarriedRural": 52763,
            "MarriedUrban": 65850
          },
          {
            "year": "2013",
            "UnmarriedRural": 7690,
            "UnmarriedUrban": 14653,
            "MarriedRural": 49036,
            "MarriedUrban": 59994
          },
          {
            "year": "2014",
            "UnmarriedRural": 8187,
            "UnmarriedUrban": 15327,
            "MarriedRural": 48393,
            "MarriedUrban": 57711
          },
          {
            "year": "2015",
            "UnmarriedRural": 8201,
            "UnmarriedUrban": 15428,
            "MarriedRural": 45741,
            "MarriedUrban": 54624
          },
          {
            "year": "2016",
            "UnmarriedRural": 8466,
            "UnmarriedUrban": 16832,
            "MarriedRural": 46589,
            "MarriedUrban": 54764
          },
          {
            "year": "2017",
            "UnmarriedRural": 8718,
            "UnmarriedUrban": 17267,
            "MarriedRural": 49856,
            "MarriedUrban": 56623
          }  
    ]
]


var chart_width     =   150;
var chart_height    =   400;
var color           =   d3.scaleOrdinal( d3.schemeCategory10 );


var data = data1[0];// paul

// Scales
var x_scale         =   d3.scaleBand()
    .domain(d3.range(data.length))
    .range([0, chart_width])
    .paddingInner(0.05);
var y_scale         =   d3.scaleLinear()
    .domain([
        0,
        160000
        //d3.max( data, function(d){return d.UnmarriedRural + d.UnmarriedUrban + d.MarriedRural + d.MarriedUrban;})
    ])
    .range([ chart_height, 0 ]);


// Stack Layout
var stack           =   d3.stack().keys([
    'UnmarriedRural', 'UnmarriedUrban', 'MarriedRural', 'MarriedUrban'
]);



var stack_data ;//     =   stack(data);

var svg, groups;

data1.forEach(function(d, i) { 
    console.log(d + " " + i); 

    data= d;
    stack_data      =   stack(data);


// Create SVG Element
 svg             =   d3.select("#chart")
    .append("svg")
    .attr("width", chart_width)
    .attr("height", chart_height);

// Groups
 groups          =   svg.selectAll( 'g' )
    .data( stack_data )
    .enter()
    .append( 'g' )
    .style( 'fill', function( d, i ){
        return color( i );
    });

// Rectangles
groups.selectAll( 'rect' )
    .data(function( d ){
        return d;
    })
    .enter()
    .append("rect")
    .attr("x", function(d, i) {
        return x_scale(i);
    })
    .attr("y", function(d) {
        return y_scale(d[1]);
    })
    .attr("height", function(d) {
        return y_scale(d[0]) - y_scale(d[1]);
    })
    .attr("width", x_scale.bandwidth());


});

    var x = d3.scaleTime().range([0, chart_width]),      // No domains yet!
    y = d3.scaleLinear().range([chart_height, 0]);
    var xAxis = d3.axisBottom(x).tickSizeInner(2).tickSizeOuter(0);
    var yAxis = d3.axisLeft(y).ticks(5).tickSizeInner(-chart_width).tickSizeOuter(0);
    var xAxisGroup = svg.append('g').attr('class', 'x d3-axis').attr('transform', 'translate(0,' + chart_height + ')');
    var yAxisGroup = svg.append('g').attr('class', 'y d3-axis').attr('transform', 'translate(0,50)');
